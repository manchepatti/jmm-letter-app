<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <!-- Mobile / PWA -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#68c751">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <title>JMM Letter Maker</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400;700&family=Noto+Sans+Devanagari:wght@400;700&family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css">
  <link rel="manifest" href="manifest.json">
</head>

<body>

<div class="app-container">

  <!-- ================= DASHBOARD ================= -->
  <div id="dashboardView" class="dashboard-container">

    <div class="dashboard-header">
      <h1>Letter Dashboard</h1>
      <div class="header-actions">
        <button id="openHistoryBtn">ğŸ“œ History</button>
        <button id="openSettingsBtn">âš™ï¸</button>
      </div>
    </div>

    <div class="dashboard-content">

      <!-- LEFT : LETTER FORM -->
      <div class="control-panel">
        <h2>Letter Details</h2>

        <div class="control-group">
          <label>Ref No</label>
          <input type="text" id="refInput">
        </div>

        <div class="control-group">
          <label>Date</label>
          <input type="date" id="dateInput">
        </div>

        <div class="control-group">
          <label>To</label>
          <textarea id="toInput" rows="3"></textarea>
        </div>

        <div class="control-group">
          <label>Letter Body</label>
          <textarea id="bodyInput" rows="6"></textarea>
        </div>

        <button id="generatePreviewBtn" class="primary-action-btn">
          ğŸ“„ Generate Preview
        </button>
      </div>

      <!-- RIGHT : HISTORY (DESKTOP ONLY) -->
      <div class="history-panel">
        <h2>Letter History</h2>
        <div id="historyList"></div>
      </div>

    </div>
  </div>

  <!-- ================= MOBILE HISTORY PAGE ================= -->
  <div id="historyMobilePage" class="history-panel hidden-view">
    <div class="dashboard-header">
      <button id="closeHistoryBtn">â† Back</button>
      <h1>Letter History</h1>
      <span></span>
    </div>
    <div id="historyListMobile"></div>
  </div>

  <!-- ================= PREVIEW ================= -->
  <div id="previewView" class="preview-container hidden-view">
    <div class="preview-toolbar">
      <button id="backToDashboardBtn">â† Back</button>
      <div>
        <button id="saveLetterBtn">ğŸ’¾ Save</button>
        <button onclick="window.print()">ğŸ–¨ï¸ Print</button>
      </div>
    </div>

    <div class="letter-scroll-area">
      <div class="letter-page">
        <header class="letter-header">
          <div class="header-line urdu">Ø¬Ù…Ø§Ø¹Øª Ø§Ù„Ù…Ø³Ù„Ù…ÛŒÙ† Ù…Ø§Ù†Ú†Û’</div>
          <div class="header-line hindi">à¤œà¤®à¤¾à¤¤à¥à¤² à¤®à¥à¤¸à¥à¤²à¤¿à¤®à¥€à¤¨ à¤®à¤£à¤šà¥‡</div>
          <div class="header-line english">Jamatul Muslimeen Manche</div>
        </header>

        <div class="letter-body" id="letterBody"></div>
      </div>
    </div>
  </div>

</div>

<!-- ================= APP SCRIPT ================= -->
<script src="script.js"></script>

<!-- ================= MOBILE HISTORY LOGIC ================= -->
<script>
  const openHistoryBtn = document.getElementById('openHistoryBtn');
  const closeHistoryBtn = document.getElementById('closeHistoryBtn');
  const historyMobilePage = document.getElementById('historyMobilePage');
  const dashboardView = document.getElementById('dashboardView');

  // Open history page on mobile
  openHistoryBtn.addEventListener('click', () => {
    if (window.innerWidth <= 768) {
      dashboardView.classList.add('hidden-view');
      historyMobilePage.classList.remove('hidden-view');

      // clone history list
      const desktopHistory = document.getElementById('historyList');
      const mobileHistory = document.getElementById('historyListMobile');
      mobileHistory.innerHTML = desktopHistory.innerHTML;
    }
  });

  // Close history page
  closeHistoryBtn.addEventListener('click', () => {
    historyMobilePage.classList.add('hidden-view');
    dashboardView.classList.remove('hidden-view');
  });
</script>

<!-- ================= SERVICE WORKER ================= -->
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>

</body>
</html>
